<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Smart Financial Tracker - Black Neon Edition</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
  body {
    background: #0b0c0e;
    color: #e7ecf3;
    font-family: system-ui, sans-serif;
    margin: 0;
    padding: 0;
  }
  header {
    background: linear-gradient(90deg, #14161b, #1a1c25);
    padding: 20px;
    border-bottom: 1px solid #1f2937;
    box-shadow: 0 0 20px rgba(124,92,255,0.6);
    display:flex;
    justify-content:space-between;
    align-items:center;
  }
  header h1 { margin:0; font-size: 1.5rem; color:#7c5cff; }
  header .stats { font-size:0.9rem; color:#9aa3b2; }

  .grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(320px,1fr)); gap:16px; padding:20px; }

  .tile {
    background:#14161b;
    border:1px solid #1f2937;
    border-radius:16px;
    padding:20px;
    box-shadow:0 0 12px rgba(124,92,255,0.4);
    transition: all 0.3s ease;
  }
  .tile:hover { box-shadow:0 0 20px rgba(124,92,255,0.8); }
  .tile h2 { margin-top:0; color:#7c5cff; display:flex; align-items:center; gap:8px; }

  .progress-bar {
    background:#1f2937;
    border-radius:10px;
    overflow:hidden;
    margin:6px 0;
    height:14px;
  }
  .progress-fill {
    height:100%;
    background:linear-gradient(90deg,#7c5cff,#00d7c0);
    width:0;
    transition:width 0.6s ease;
  }
  .btn {
    padding:8px 12px;
    border-radius:8px;
    border:none;
    cursor:pointer;
    font-weight:600;
  }
  .btn-save { background:#7c5cff; color:#fff; margin-left:10px; }
  .btn-settings { background:#1f2937; color:#9aa3b2; margin-left:10px; }
  #settings-panel {
    display:none;position:fixed;top:0;right:0;width:420px;height:100%;
    background:#0f1116;color:#fff;padding:20px;
    box-shadow:-2px 0 15px rgba(0,0,0,0.6);overflow:auto;z-index:100;
  }
  #settings-panel input, #settings-panel select {
    width:100%;margin:4px 0;padding:6px;border-radius:6px;border:none;
    background:#1a1c25;color:#fff;
  }
  #settings-panel table { width:100%;border-collapse:collapse;margin-bottom:12px; }
  #settings-panel th, #settings-panel td {
    border:1px solid #333;padding:6px;text-align:left;
  }
  #settings-panel th { background:#1a1c25;color:#7c5cff; }
  #settings-panel button.small { padding:4px 8px;font-size:0.8rem; }
</style>
</head>
<body>

<header>
  <h1><i class="fa-solid fa-coins"></i> Smart Financial Tracker</h1>
  <div class="stats">
    Next Payday: <span id="header-next-payday">--</span> |
    Daily: <span id="header-daily">$--</span>
    <button class="btn btn-save" onclick="saveNow()">üíæ Save Now</button>
    <button class="btn btn-settings" onclick="toggleSettings()">‚öôÔ∏è Settings</button>
  </div>
</header>

<main class="grid">
  <section class="tile">
    <h2><i class="fa-solid fa-wallet"></i> Spendable Now</h2>
    <div id="spendable-now" style="font-size:2rem;">$‚Äî</div>
  </section>

  <section class="tile">
    <h2><i class="fa-solid fa-calendar-day"></i> Daily Budget</h2>
    <div id="daily-budget" style="font-size:1.5rem;">$‚Äî / day</div>
  </section>

  <section class="tile">
    <h2><i class="fa-solid fa-sack-dollar"></i> Upcoming Income</h2>
    <ul id="upcoming-income"></ul>
  </section>

  <section class="tile">
    <h2><i class="fa-solid fa-file-invoice-dollar"></i> Bills Due Before Payday</h2>
    <div id="bills-due"></div>
  </section>

  <section class="tile">
    <h2><i class="fa-solid fa-university"></i> Balances by Bank</h2>
    <ul id="bank-balances"></ul>
  </section>

  <section class="tile">
    <h2><i class="fa-solid fa-chart-pie"></i> Category Tracker</h2>
    <div id="categories"></div>
  </section>

  <section class="tile">
    <h2><i class="fa-solid fa-receipt"></i> Transactions</h2>
    <div id="transactions"></div>
  </section>

  <section class="tile">
    <h2><i class="fa-solid fa-lightbulb"></i> AI Insights</h2>
    <p id="ai-insights">üí° Loading...</p>
  </section>
</main>

<!-- Settings Panel -->
<div id="settings-panel">
  <h2><i class="fa-solid fa-gear"></i> Settings</h2>
  <button onclick="toggleSettings()">Close</button>

  <h3>Pay Schedules</h3>
  <div id="settings-pay"></div>
  <button onclick="addPay()">+ Add Pay Schedule</button>

  <h3>Bills</h3>
  <div id="settings-bills"></div>
  <button onclick="addBill()">+ Add Bill</button>

  <h3>Categories</h3>
  <div id="settings-categories"></div>
  <button onclick="addCategory()">+ Add Category</button>

  <h3>Banks</h3>
  <div id="settings-banks"></div>
  <button onclick="addBank()">+ Add Bank</button>

  <h3>Backups</h3>
  <div id="backup-list"></div>
</div>

<script>
  // === Data Seeds ===
  let PAY_SCHEDULES = [
    { who:"Steve (SoFi)", frequency:"biweekly", anchor:"2025-08-22", amount:400, target:"SoFi" },
    { who:"Steve (BofA)", frequency:"biweekly", anchor:"2025-08-22", amount:1027.42, target:"BofA" },
    { who:"Tanci (USAA)", frequency:"semimonthly", days:[15,30], amount:1851.04, target:"USAA" }
  ];
  let DEFAULT_BILLS = [
    { name:"Rent (1st Half)", amount:750, cadence:"monthly", day:1, category:"Housing" },
    { name:"Rent (2nd Half)", amount:750, cadence:"monthly", day:15, category:"Housing" },
    { name:"NV Energy", amount:120, cadence:"monthly", day:10, category:"Utilities" },
    { name:"Water", amount:75, cadence:"monthly", day:12, category:"Utilities" },
    { name:"Car Insurance", amount:160, cadence:"monthly", day:25, category:"Insurance" },
    { name:"Property Taxes", amount:400, cadence:"quarterly", day:30, category:"Housing" }
  ];
  let DEFAULT_CATEGORIES = [
    "Housing","Utilities","Insurance","Groceries","Gas for Cars",
    "Subscriptions","Dining/Entertainment","Shopping","Health/Medical",
    "Home/Garden","Income/Paycheck","Transfer Between Banks","Cash Withdrawal",
    "Investment/Savings","Bills/Other","Fees","Refund/Credit"
  ];
  let BANKS = [
    { name:"BofA", balance:500 },
    { name:"SoFi", balance:200 },
    { name:"USAA", balance:1000 },
    { name:"CapOne", balance:300 }
  ];

  // === Household Math Engine ===
  function nextPayday(schedule){
    const today = new Date();
    if(schedule.frequency==="biweekly"){
      let anchor=new Date(schedule.anchor);
      while(anchor<=today){ anchor.setDate(anchor.getDate()+14); }
      return anchor;
    }
    if(schedule.frequency==="semimonthly"){
      let d1=new Date(today.getFullYear(), today.getMonth(), schedule.days[0]);
      let d2=new Date(today.getFullYear(), today.getMonth(), schedule.days[1]);
      if(today<d1) return d1;
      if(today<d2) return d2;
      return new Date(today.getFullYear(), today.getMonth()+1, schedule.days[0]);
    }
    return null;
  }

  function calcMath(){
    const today=new Date();
    let nextPay=PAY_SCHEDULES.map(nextPayday).filter(d=>d).sort((a,b)=>a-b)[0];
    let daysLeft=Math.ceil((nextPay-today)/(1000*60*60*24));
    document.getElementById("header-next-payday").textContent=nextPay?nextPay.toDateString():"--";

    let balances=BANKS.reduce((a,b)=>a+b.balance,0);
    let upcomingIncome=PAY_SCHEDULES.filter(p=>{
      let d=nextPayday(p);return d && d<=nextPay;
    }).reduce((a,b)=>a+b.amount,0);
    let billsDue=DEFAULT_BILLS.filter(b=>{
      let due=new Date(today.getFullYear(), today.getMonth(), b.day);
      if(due<today) due.setMonth(due.getMonth()+1);
      return due<=nextPay;
    }).reduce((a,b)=>a+b.amount,0);

    let spendable=balances+upcomingIncome-billsDue;
    let daily=(daysLeft>0)?(spendable/daysLeft):spendable;

    document.getElementById("spendable-now").textContent="$"+spendable.toFixed(2);
    document.getElementById("daily-budget").textContent="$"+daily.toFixed(2)+" / day";
    document.getElementById("header-daily").textContent="$"+daily.toFixed(2);

    document.getElementById("upcoming-income").innerHTML=PAY_SCHEDULES.map(p=>{
      let d=nextPayday(p);
      return `<li>${p.who}: $${p.amount} (${d?d.toDateString():""})</li>`;
    }).join("");

    document.getElementById("bills-due").innerHTML=DEFAULT_BILLS.map(b=>{
      return `<div>${b.name}: $${b.amount}</div>`;
    }).join("");

    document.getElementById("bank-balances").innerHTML=BANKS.map(b=>`<li>${b.name}: $${b.balance.toFixed(2)}</li>`).join("");

    document.getElementById("categories").innerHTML=DEFAULT_CATEGORIES.map(c=>
      `<div>${c}<div class='progress-bar'><div class='progress-fill' style='width:${Math.random()*100}%'></div></div></div>`
    ).join("");
  }

  // === Backup System ===
  function saveNow(){
    const snapshot = {
      time:new Date().toLocaleString(),
      pays:PAY_SCHEDULES,
      bills:DEFAULT_BILLS,
      categories:DEFAULT_CATEGORIES,
      banks:BANKS
    };
    let backups = JSON.parse(localStorage.getItem("smd_backups")||"[]");
    backups.unshift(snapshot);
    if(backups.length>10) backups=backups.slice(0,10);
    localStorage.setItem("smd_backups",JSON.stringify(backups));
    alert("Backup saved!");
    renderBackups();
  }
  function renderBackups(){
    let backups = JSON.parse(localStorage.getItem("smd_backups")||"[]");
    document.getElementById("backup-list").innerHTML = backups.map(b=>`<div>${b.time} <button onclick='restoreBackup("${b.time}")'>Restore</button></div>`).join("");
  }
  function restoreBackup(time){
    let backups = JSON.parse(localStorage.getItem("smd_backups")||"[]");
    let b = backups.find(x=>x.time===time);
    if(b){
      PAY_SCHEDULES=b.pays;DEFAULT_BILLS=b.bills;DEFAULT_CATEGORIES=b.categories;BANKS=b.banks;
      calcMath();toggleSettings();toggleSettings();
    }
  }

  // === Settings Panel Render ===
  function toggleSettings(){
    const el=document.getElementById("settings-panel");
    el.style.display=(el.style.display==="none")?"block":"none";
    if(el.style.display==="block"){ renderSettings(); renderBackups(); }
  }
  function renderSettings(){
    // Pay
    let payHtml="<table><tr><th>Who</th><th>Freq</th><th>Amt</th><th>Target</th></tr>";
    PAY_SCHEDULES.forEach((p,i)=>{
      payHtml+=`<tr><td><input value="${p.who}" onchange="PAY_SCHEDULES[${i}].who=this.value"></td>
        <td><input value="${p.frequency}" onchange="PAY_SCHEDULES[${i}].frequency=this.value"></td>
        <td><input type='number' value="${p.amount}" onchange="PAY_SCHEDULES[${i}].amount=parseFloat(this.value)"></td>
        <td><input value="${p.target}" onchange="PAY_SCHEDULES[${i}].target=this.value"></td></tr>`;
    });
    payHtml+="</table>";document.getElementById("settings-pay").innerHTML=payHtml;

    // Bills
    let billHtml="<table><tr><th>Name</th><th>Amt</th><th>Day</th><th>Cat</th></tr>";
    DEFAULT_BILLS.forEach((b,i)=>{
      billHtml+=`<tr><td><input value="${b.name}" onchange="DEFAULT_BILLS[${i}].name=this.value"></td>
        <td><input type='number' value="${b.amount}" onchange="DEFAULT_BILLS[${i}].amount=parseFloat(this.value)"></td>
        <td><input type='number' value="${b.day}" onchange="DEFAULT_BILLS[${i}].day=parseInt(this.value)"></td>
        <td><input value="${b.category}" onchange="DEFAULT_BILLS[${i}].category=this.value"></td></tr>`;
    });
    billHtml+="</table>";document.getElementById("settings-bills").innerHTML=billHtml;

    // Categories
    document.getElementById("settings-categories").innerHTML=DEFAULT_CATEGORIES.map((c,i)=>
      `<div><input value="${c}" onchange="DEFAULT_CATEGORIES[${i}]=this.value"></div>`).join("");

    // Banks
    let bankHtml="<table><tr><th>Name</th><th>Balance</th></tr>";
    BANKS.forEach((b,i)=>{
      bankHtml+=`<tr><td><input value="${b.name}" onchange="BANKS[${i}].name=this.value"></td>
        <td><input type='number' value="${b.balance}" onchange="BANKS[${i}].balance=parseFloat(this.value)"></td></tr>`;
    });
    bankHtml+="</table>";document.getElementById("settings-banks").innerHTML=bankHtml;
  }

  function addPay(){ PAY_SCHEDULES.push({who:"New",frequency:"monthly",anchor:new Date().toISOString().slice(0,10),amount:0,target:"Bank"}); renderSettings(); }
  function addBill(){ DEFAULT_BILLS.push({name:"New Bill",amount:0,cadence:"monthly",day:1,category:"Other"}); renderSettings(); }
  function addCategory(){ DEFAULT_CATEGORIES.push("New Category"); renderSettings(); }
  function addBank(){ BANKS.push({name:"New Bank",balance:0}); renderSettings(); }

  // === Init ===
  calcMath();
</script>

</body>
</html>
